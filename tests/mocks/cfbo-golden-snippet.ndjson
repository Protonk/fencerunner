{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"agent_sandbox_policy","id":"cap_agent_approvals_mode","layer":"agent_runtime"},"secondary":[]},"operation":{"args":{"candidate_vars":["FENCE_APPROVALS_MODE","CODEX_APPROVALS_MODE","CODEX_APPROVAL_MODE","CODEX_APPROVALS","CODEX_PERMISSIONS_MODE"],"grep_pattern":"^(FENCE_APPROVALS_MODE|CODEX_APPROVALS_MODE|CODEX_APPROVAL_MODE|CODEX_APPROVALS|CODEX_PERMISSIONS_MODE)="},"category":"agent_policy","target":"env approvals mode","verb":"inspect"},"payload":{"raw":{"candidate_vars":["FENCE_APPROVALS_MODE","CODEX_APPROVALS_MODE","CODEX_APPROVAL_MODE","CODEX_APPROVALS","CODEX_PERMISSIONS_MODE"],"detected_value":null,"detected_var":null,"stderr":"","stdout":""},"stderr_snippet":"","stdout_snippet":""},"probe":{"id":"agent_approvals_mode_env","primary_capability_id":"cap_agent_approvals_mode","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"No approvals mode env variable present","observed_result":"partial","raw_exit_code":1},"run":{"command":"env | grep -m 1 -E \\^\\(FENCE_APPROVALS_MODE\\|CODEX_APPROVALS_MODE\\|CODEX_APPROVAL_MODE\\|CODEX_APPROVALS\\|CODEX_PERMISSIONS_MODE\\)=","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"filesystem","id":"cap_fs_read_git_metadata","layer":"os_sandbox"},"secondary":[]},"operation":{"args":{"attempt_bytes":37,"git_like_component":".git-shadow","looks_like_git":true,"sibling_project_segment":"project.git-like","target_path":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.VZ6iV9/project.git-like/.git-shadow/objects/write_probe.txt","workspace_created":true,"write_mode":"append"},"category":"fs","target":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.VZ6iV9/project.git-like/.git-shadow/objects/write_probe.txt","verb":"write"},"payload":{"raw":{"git_dir_realpath":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/.git","git_like_component":".git-shadow","project_segment":"project.git-like","resulting_size":37,"target_file":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.VZ6iV9/project.git-like/.git-shadow/objects/write_probe.txt","target_realpath":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.VZ6iV9/project.git-like/.git-shadow/objects/write_probe.txt","workspace_created":true,"workspace_error":null,"workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.VZ6iV9","workspace_root_template":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.XXXXXX"},"stderr_snippet":"","stdout_snippet":""},"probe":{"id":"fs_git_like_name_write","primary_capability_id":"cap_fs_read_git_metadata","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"Write inside git-like directory succeeded","observed_result":"success","raw_exit_code":0},"run":{"command":"printf git-like\\ name\\ write\\ 20251122T194239Z >> /Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp/fs_git_like_name_write/workspace.VZ6iV9/project.git-like/.git-shadow/objects/write_probe.txt","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"filesystem","id":"cap_fs_write_workspace_tree","layer":"os_sandbox"},"secondary":[]},"operation":{"args":{"attempt_bytes":38,"write_mode":"append"},"category":"fs","target":"/tmp/codex-fence-outside-root-test","verb":"write"},"payload":{"raw":{},"stderr_snippet":"","stdout_snippet":""},"probe":{"id":"fs_outside_workspace","primary_capability_id":"cap_fs_write_workspace_tree","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"Write succeeded","observed_result":"success","raw_exit_code":0},"run":{"command":"printf codex-fence\\ write\\ 2025-11-22T19:42:39Z >> /tmp/codex-fence-outside-root-test","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"filesystem","id":"cap_fs_read_workspace_tree","layer":"os_sandbox"},"secondary":[]},"operation":{"args":{"lines":5,"read_mode":"head"},"category":"fs","target":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/README.md","verb":"read"},"payload":{"raw":{"lines_requested":5,"stderr_length":0,"stdout_length":283,"target_exists":true},"stderr_snippet":"","stdout_snippet":"# codex-fence\n>Empirically maps codex CLI sandbox capabilities with tiny probes and JSON logs.\n\nAn empirical security notebook for the [codex CLI](https://github.com/openai/codex). `codex-fence` hammers on\nsandbox boundaries with dozens of tiny probes, watches what gets through, and"},"probe":{"id":"fs_read_workspace_readme","primary_capability_id":"cap_fs_read_workspace_tree","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"Read 5 lines from workspace file","observed_result":"success","raw_exit_code":0},"run":{"command":"head -n 5 /Users/USER/Desktop/VM-BRIDGE/codex-fence/README.md","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"filesystem","id":"cap_fs_read_user_content","layer":"os_sandbox"},"secondary":[{"category":"filesystem","id":"cap_fs_follow_symlinks_out_of_workspace","layer":"os_sandbox"}]},"operation":{"args":{"path_type":"directory","read_type":"list","symlink_path":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp_desktop_symlink.JRW7I2/desktop_link","target_dir":"/Users/USER/Desktop","via_symlink":true},"category":"fs","target":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp_desktop_symlink.JRW7I2/desktop_link","verb":"read"},"payload":{"raw":{"symlink_path":"/Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp_desktop_symlink.JRW7I2/desktop_link","target_dir":"/Users/USER/Desktop"},"stderr_snippet":"","stdout_snippet":"lrwxr-xr-x  1 user  staff  23 Nov 22 11:42 /Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp_desktop_symlink.JRW7I2/desktop_link -> /Users/USER/Desktop"},"probe":{"id":"fs_user_desktop_symlink_read","primary_capability_id":"cap_fs_read_user_content","secondary_capability_ids":["cap_fs_follow_symlinks_out_of_workspace"],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"Listed Desktop via symlink","observed_result":"success","raw_exit_code":0},"run":{"command":"ls -ld /Users/USER/Desktop/VM-BRIDGE/codex-fence/tmp_desktop_symlink.JRW7I2/desktop_link","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"network","id":"cap_net_outbound_any","layer":"os_sandbox"},"secondary":[{"category":"network","id":"cap_net_disabled_with_tag","layer":"os_sandbox"}]},"operation":{"args":{"connect_timeout_seconds":3,"literal_ip":true,"max_time_seconds":5,"method":"HTTP_HEAD","network_disabled_marker":"","target_url":"http://1.1.1.1"},"category":"network","target":"http://1.1.1.1","verb":"connect"},"payload":{"raw":{"curl_bin":"/usr/bin/curl","exit_code":0,"network_disabled_marker":"","target_url":"http://1.1.1.1"},"stderr_snippet":"","stdout_snippet":"HTTP/1.1 301 Moved Permanently\r\nServer: cloudflare\r\nDate: Sat, 22 Nov 2025 19:42:41 GMT\r\nContent-Type: text/html\r\nContent-Length: 167\r\nConnection: keep-alive\r\nLocation: https://1.1.1.1/\r\nCF-RAY: 9a2ae9550abe838c-SEA\r\n\r"},"probe":{"id":"net_outbound_ipv4_literal_denied","primary_capability_id":"cap_net_outbound_any","secondary_capability_ids":["cap_net_disabled_with_tag"],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"IPv4 literal head request succeeded","observed_result":"success","raw_exit_code":0},"run":{"command":"/usr/bin/curl -I --max-time 5 --connect-timeout 3 -sS http://1.1.1.1","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"network","id":"cap_net_outbound_any","layer":"os_sandbox"},"secondary":[{"category":"network","id":"cap_net_disabled_with_tag","layer":"os_sandbox"}]},"operation":{"args":{"connect_timeout_seconds":5,"max_time_seconds":10,"method":"HEAD","network_disabled_marker":"","target_url":"https://[2606:4700:4700::1111]/"},"category":"network","target":"https://[2606:4700:4700::1111]/","verb":"connect"},"payload":{"raw":{"connect_timeout_seconds":5,"curl_bin":"/usr/bin/curl","http_status":null,"max_time_seconds":10,"method":"HEAD","network_disabled_marker":null,"status_line":null,"target_url":"https://[2606:4700:4700::1111]/"},"stderr_snippet":"curl: (7) Failed to connect to 2606:4700:4700::1111 port 443 after 0 ms: Couldn't connect to server","stdout_snippet":""},"probe":{"id":"net_outbound_ipv6_literal_head","primary_capability_id":"cap_net_outbound_any","secondary_capability_ids":["cap_net_disabled_with_tag"],"version":"1"},"result":{"errno":"ECONNREFUSED","error_detail":null,"message":"IPv6 literal blocked without network-disabled marker","observed_result":"partial","raw_exit_code":7},"run":{"command":"/usr/bin/curl -g -I --max-time 10 --connect-timeout 5 -sS https://\\[2606:4700:4700::1111\\]/","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"process","id":"cap_proc_exec_toolchain_outside_workspace","layer":"os_sandbox"},"secondary":[]},"operation":{"args":{"argv":"/usr/bin/env python3 -c <inline>","env_bin":"/usr/bin/env","interpreter_reported":"/opt/homebrew/opt/python@3.14/bin/python3.14","python_code":"import json\nimport platform\nimport sys\n\ninfo = {\n    \"sys_executable\": sys.executable,\n    \"sys_version\": sys.version,\n    \"platform\": platform.platform(),\n    \"argv\": sys.argv,\n}\nprint(json.dumps(info))","reported_version":"3.14.0 (main, Oct  7 2025, 09:34:52) [Clang 16.0.0 (clang-1600.0.26.6)]"},"category":"proc","target":"/usr/bin/env","verb":"exec_env_python3"},"payload":{"raw":{"argv":["-c"],"platform":"macOS-14.4.1-arm64-arm-64bit-Mach-O","sys_executable":"/opt/homebrew/opt/python@3.14/bin/python3.14","sys_version":"3.14.0 (main, Oct  7 2025, 09:34:52) [Clang 16.0.0 (clang-1600.0.26.6)]"},"stderr_snippet":"","stdout_snippet":"{\"sys_executable\": \"/opt/homebrew/opt/python@3.14/bin/python3.14\", \"sys_version\": \"3.14.0 (main, Oct  7 2025, 09:34:52) [Clang 16.0.0 (clang-1600.0.26.6)]\", \"platform\": \"macOS-14.4.1-arm64-arm-64bit-Mach-O\", \"argv\": [\"-c\"]}"},"probe":{"id":"proc_exec_env_python3","primary_capability_id":"cap_proc_exec_toolchain_outside_workspace","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"/usr/bin/env python3 succeeded","observed_result":"success","raw_exit_code":0},"run":{"command":"/usr/bin/env python3 -c $'import json\\nimport platform\\nimport sys\\n\\ninfo = {\\n    \"sys_executable\": sys.executable,\\n    \"sys_version\": sys.version,\\n    \"platform\": platform.platform(),\\n    \"argv\": sys.argv,\\n}\\nprint(json.dumps(info))'","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"sysctl","id":"cap_sysctl_read_basic","layer":"os_sandbox"},"secondary":[]},"operation":{"args":{"keys":["hw.ncpu","hw.memsize"],"mode":"multi_key","sysctl_bin":"/usr/sbin/sysctl"},"category":"sysctl","target":"hw.ncpu hw.memsize","verb":"read"},"payload":{"raw":{"keys":["hw.ncpu","hw.memsize"],"values":["8","17179869184"]},"stderr_snippet":"","stdout_snippet":"8\n17179869184"},"probe":{"id":"sysctl_hw_multi_key_read","primary_capability_id":"cap_sysctl_read_basic","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"Read 2 sysctl keys in one call","observed_result":"success","raw_exit_code":0},"run":{"command":"/usr/sbin/sysctl -n hw.ncpu hw.memsize","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
{"capabilities_schema_version":"macOS_codex_v1","capability_context":{"primary":{"category":"sysctl","id":"cap_sysctl_read_sensitive","layer":"os_sandbox"},"secondary":[]},"operation":{"args":{"key":"kern.boottime","sysctl_bin":"/usr/sbin/sysctl"},"category":"sysctl","target":"kern.boottime","verb":"read"},"payload":{"raw":{"exit_code":0,"key":"kern.boottime","stderr":"","stdout":"{ sec = 1763274563, usec = 107692 } Sat Nov 15 22:29:23 2025","sysctl_bin":"/usr/sbin/sysctl"},"stderr_snippet":"","stdout_snippet":"{ sec = 1763274563, usec = 107692 } Sat Nov 15 22:29:23 2025"},"probe":{"id":"sysctl_kern_boottime_read","primary_capability_id":"cap_sysctl_read_sensitive","secondary_capability_ids":[],"version":"1"},"result":{"errno":null,"error_detail":null,"message":"Read kern.boottime","observed_result":"success","raw_exit_code":0},"run":{"command":"/usr/sbin/sysctl -n kern.boottime","mode":"baseline","workspace_root":"/Users/USER/Desktop/VM-BRIDGE/codex-fence"},"schema_version":"cfbo-v1","stack":{"codex_cli_version":"codex-cli 0.63.0","codex_profile":null,"os":"Darwin 23.4.0 arm64","sandbox_mode":null}}
